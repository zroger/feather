parameters:
  feather.class: "Zroger\\Feather\\Feather"
  feather.log_reader.class: "Zroger\\Feather\\LogReader"
  feather.logger.class: "Zroger\\Feather\\Log\\ConsoleLogger"

services:
  feather:
    class: "%feather.class%"
    arguments: ["%feather.server_root%", "%feather.document_root%", "@feather_logger"]
    calls:
      - [setConfigFile, ["%feather.config_file%"]]
      - [setPort, ["%feather.port%"]]
      - [setLogLevel, ["%feather.log_level%"]]
      - [setModules, ["%feather.modules%"]]
      - [setErrorLog, ["%feather.error_log%"]]
      - [setAccessLog, ["%feather.access_log%"]]
  error_log_reader:
    class: "Zroger\\Feather\\Log\\FileReader"
    arguments: ["%feather.error_log%"]
  access_log_reader:
    class: "Zroger\\Feather\\Log\\FileReader"
    arguments: ["%feather.access_log%"]
  log_watcher:
    class: "Zroger\\Feather\\Log\Watcher"
    calls:
      - [addReader, ["error_log", "@error_log_reader"]]
      - [addReader, ["access_log", "@access_log_reader"]]
  feather_logger:
    class: "%feather.logger.class%"
